<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notifications - Medical Recommendation System</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/notifications.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/common.css') }}">
</head>
<body>
    <div class="dashboard-container">
        <nav class="navbar">
            <h1>üè• Medical Dashboard</h1>
            <div class="nav-links">
                <a href="{{ url_for('dashboard') }}">Dashboard</a>
                <a href="{{ url_for('predict') }}">New Prediction</a>
                <a href="{{ url_for('history') }}" class="active">History</a>
                <a href="{{ url_for('logout') }}">Logout</a>
            </div>
        </nav>
        
        <main class="dashboard-content">
            <h2>üîî Notifications & Alerts</h2>
            
            <div class="notifications-container">
                <!-- Filter Options -->
                <div class="form-box notifications-filter-box">
                    <form method="GET" action="{{ url_for('notifications') }}" class="filter-form">
                        <div class="form-group">
                            <label for="filter_type">Filter by Type</label>
                            <select id="filter_type" name="filter_type">
                                <option value="all">All Notifications</option>
                                <option value="critical">Critical Alerts</option>
                                <option value="reminder">Reminders</option>
                                <option value="result">Test Results</option>
                                <option value="appointment">Appointments</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="filter_status">Status</label>
                            <select id="filter_status" name="filter_status">
                                <option value="all">All</option>
                                <option value="unread">Unread Only</option>
                                <option value="read">Read Only</option>
                            </select>
                        </div>
                        
                        <div class="filter-actions">
                            <button type="submit" class="btn btn-primary">Apply Filter</button>
                        </div>
                    </form>
                    <form method="POST" action="{{ url_for('mark_all_read') }}" class="filter-actions">
                        <button type="submit" class="btn btn-secondary">Mark All as Read</button>
                    </form>
                </div>
                
                <!-- Notifications List -->
                {% if notifications %}
                <div class="notifications-grid">
                    {% for notification in notifications %}
                    <div class="notification-card {% if not notification.is_read %}unread{% endif %} {% if notification.priority %}priority-{{ notification.priority }}{% endif %}">
                        
                        <div class="notification-header">
                            <div class="notification-content">
                                <div class="notification-title-row">
                                    {% if notification.priority == 'critical' %}
                                    <span class="notification-icon">üö®</span>
                                    {% elif notification.type == 'reminder' %}
                                    <span class="notification-icon">‚è∞</span>
                                    {% elif notification.type == 'result' %}
                                    <span class="notification-icon">üìä</span>
                                    {% elif notification.type == 'appointment' %}
                                    <span class="notification-icon">üìÖ</span>
                                    {% else %}
                                    <span class="notification-icon">üîî</span>
                                    {% endif %}
                                    
                                    <h4 class="notification-title">{{ notification.title }}</h4>
                                    
                                    {% if not notification.is_read %}
                                    <span class="notification-badge">NEW</span>
                                    {% endif %}
                                </div>
                                
                                <p class="notification-message">{{ notification.message }}</p>
                                
                                <div class="notification-meta">
                                    <span>üìÖ {{ notification.date }} at {{ notification.time }}</span>
                                </div>
                            </div>
                            
                            <div class="notification-actions">
                                {% if not notification.is_read %}
                                <form method="POST" action="{{ url_for('mark_notification_read', notification_id=notification.id) }}">
                                    <button type="submit" class="btn-mark-read">Mark Read</button>
                                </form>
                                {% endif %}
                                
                                <form method="POST" action="{{ url_for('delete_notification', notification_id=notification.id) }}">
                                    <button type="submit" class="btn-delete">Delete</button>
                                </form>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                <!-- Pagination (if needed) -->
                {% if total_pages > 1 %}
                <div class="pagination">
                    {% if current_page > 1 %}
                    <a href="{{ url_for('notifications', page=current_page-1) }}" class="btn btn-secondary">‚Üê Previous</a>
                    {% endif %}
                    
                    <span class="pagination-info">Page {{ current_page }} of {{ total_pages }}</span>
                    
                    {% if current_page < total_pages %}
                    <a href="{{ url_for('notifications', page=current_page+1) }}" class="btn btn-secondary">Next ‚Üí</a>
                    {% endif %}
                </div>
                {% endif %}
                
                {% else %}
                <div class="no-notifications">
                    <p>No notifications to display.</p>
                </div>
                {% endif %}
                
                <div class="back-button-container">
                    <a href="{{ url_for('history') }}" class="btn btn-secondary">‚Üê Back to History</a>
                    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Dashboard</a>
                </div>
            </div>
        </main>
    </div>
</body>
</html>
